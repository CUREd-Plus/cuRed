-- Import HES Outpatient (OP) data to DuckDB
CREATE TABLE hes_op AS
SELECT *
FROM read_csv('FILE*.txt',
  delim='|',
  header=true,
  filename=true,
  -- Columns must be ordered
  columns={'ACTIVAGE': 'VARCHAR', 'ADMINCAT': 'VARCHAR', 'APPTAGE_CALC': 'FLOAT', 'APPTDATE': 'DATE', 'AT_GP_PRACTICE': 'VARCHAR', 'AT_RESIDENCE': 'VARCHAR', 'AT_TREATMENT': 'VARCHAR', 'ATENTYPE': 'VARCHAR', 'ATTENDED': 'VARCHAR', 'ATTENDKEY': 'VARCHAR', 'CANNET': 'VARCHAR', 'CANREG': 'VARCHAR', 'CARERSI': 'VARCHAR', 'CCG_GP_PRACTICE': 'VARCHAR', 'CCG_RESIDENCE': 'VARCHAR', 'CCG_RESPONSIBILITY': 'VARCHAR', 'CCG_TREATMENT': 'VARCHAR', 'DIAG_01': 'VARCHAR', 'DIAG_02': 'VARCHAR', 'DIAG_03': 'VARCHAR', 'DIAG_04': 'VARCHAR', 'DIAG_05': 'VARCHAR', 'DIAG_06': 'VARCHAR', 'DIAG_07': 'VARCHAR', 'DIAG_08': 'VARCHAR', 'DIAG_09': 'VARCHAR', 'DIAG_10': 'VARCHAR', 'DIAG_11': 'VARCHAR', 'DIAG_12': 'VARCHAR', 'DIAG_3_01': 'VARCHAR', 'DIAG_3_02': 'VARCHAR', 'DIAG_3_03': 'VARCHAR', 'DIAG_3_04': 'VARCHAR', 'DIAG_3_05': 'VARCHAR', 'DIAG_3_06': 'VARCHAR', 'DIAG_3_07': 'VARCHAR', 'DIAG_3_08': 'VARCHAR', 'DIAG_3_09': 'VARCHAR', 'DIAG_3_10': 'VARCHAR', 'DIAG_3_11': 'VARCHAR', 'DIAG_3_12': 'VARCHAR', 'DIAG_3_CONCAT': 'VARCHAR', 'DIAG_4_01': 'VARCHAR', 'DIAG_4_02': 'VARCHAR', 'DIAG_4_03': 'VARCHAR', 'DIAG_4_04': 'VARCHAR', 'DIAG_4_05': 'VARCHAR', 'DIAG_4_06': 'VARCHAR', 'DIAG_4_07': 'VARCHAR', 'DIAG_4_08': 'VARCHAR', 'DIAG_4_09': 'VARCHAR', 'DIAG_4_10': 'VARCHAR', 'DIAG_4_11': 'VARCHAR', 'DIAG_4_12': 'VARCHAR', 'DIAG_4_CONCAT': 'VARCHAR', 'DIAG_COUNT': 'UBIGINT', 'DNADATE': 'DATE', 'ETHNOS': 'VARCHAR', 'ETHRAWL': 'VARCHAR', 'FIRSTATT': 'VARCHAR', 'GPPRAC': 'VARCHAR', 'HRGNHS': 'VARCHAR', 'HRGNHSVN': 'VARCHAR', 'IMD04': 'FLOAT', 'IMD04_DECILE': 'VARCHAR', 'IMD04C': 'FLOAT', 'IMD04ED': 'FLOAT', 'IMD04EM': 'FLOAT', 'IMD04HD': 'FLOAT', 'IMD04HS': 'FLOAT', 'IMD04I': 'FLOAT', 'IMD04IA': 'FLOAT', 'IMD04IC': 'FLOAT', 'IMD04LE': 'FLOAT', 'IMD04RK': 'UBIGINT', 'LOCTYPE': 'VARCHAR', 'LSOA01': 'VARCHAR', 'LSOA11': 'VARCHAR', 'MAINSPEF': 'VARCHAR', 'MARSTAT': 'VARCHAR', 'NODIAGS': 'UBIGINT', 'NOPROCS': 'UBIGINT', 'OACODE11': 'VARCHAR', 'OPERSTAT': 'VARCHAR', 'OPERTN_01': 'VARCHAR', 'OPERTN_02': 'VARCHAR', 'OPERTN_03': 'VARCHAR', 'OPERTN_04': 'VARCHAR', 'OPERTN_05': 'VARCHAR', 'OPERTN_06': 'VARCHAR', 'OPERTN_07': 'VARCHAR', 'OPERTN_08': 'VARCHAR', 'OPERTN_09': 'VARCHAR', 'OPERTN_10': 'VARCHAR', 'OPERTN_11': 'VARCHAR', 'OPERTN_12': 'VARCHAR', 'OPERTN_13': 'VARCHAR', 'OPERTN_14': 'VARCHAR', 'OPERTN_15': 'VARCHAR', 'OPERTN_16': 'VARCHAR', 'OPERTN_17': 'VARCHAR', 'OPERTN_18': 'VARCHAR', 'OPERTN_19': 'VARCHAR', 'OPERTN_20': 'VARCHAR', 'OPERTN_21': 'VARCHAR', 'OPERTN_22': 'VARCHAR', 'OPERTN_23': 'VARCHAR', 'OPERTN_24': 'VARCHAR', 'OPERTN_3_01': 'VARCHAR', 'OPERTN_4_01': 'VARCHAR', 'OPERTN_4_CONCAT': 'VARCHAR', 'OUTCOME': 'VARCHAR', 'PARTYEAR': 'UBIGINT', 'PCONSULT': 'VARCHAR', 'PGPPRAC': 'VARCHAR', 'PREFERER': 'VARCHAR', 'PRIORITY': 'UBIGINT', 'PROCODET': 'VARCHAR', 'PROTYPE': 'VARCHAR', 'REFERORG': 'VARCHAR', 'REFSOURC': 'VARCHAR', 'REQDATE': 'DATE', 'SENDER': 'VARCHAR', 'SERVTYPE': 'UBIGINT', 'SEX': 'VARCHAR', 'SITETRET': 'VARCHAR', 'STAFFTYP': 'VARCHAR', 'SUSHRG': 'VARCHAR', 'SUSHRGVERS': 'VARCHAR', 'SUSLDDATE': 'DATE', 'SUSRECID': 'UBIGINT', 'SUSSPELLID': 'VARCHAR', 'Token_Person_ID': 'VARCHAR', 'TRETSPEF': 'VARCHAR', 'WAIT_IND': 'UBIGINT', 'WAITING': 'UBIGINT'}
);
