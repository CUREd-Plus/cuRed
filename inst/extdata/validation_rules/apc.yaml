---
# APC data validation rules

# This file is written using YAML format.
# https://cran.r-project.org/web/packages/validate/vignettes/cookbook.html#82_Metadata_in_text_files:_YAML

# Each rule has the following arguments:
# TODO

rules:
# ðŸ”‘ EPIKEY (HES Record Identifier)
- name: EPIKEY 19n
  description: EPIKEY has 19 integers (2021-22 onwards)
# https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/grep
  expr: grepl("^\\d{19}$", EPIKEY)

- name: EPIKEY 12n
  description: EPIKEY has 12 integers (1989-90 to 2020-21)
  expr: grepl("^\\d{12}$", EPIKEY)
  
- name: EPIKEY is required
# In YAML, we need to use quotes for special characters
# https://stackoverflow.com/a/22235064/15368268
  expr: '!is.na(EPIKEY)'
  meta:
    severity: error
  
- name: EPIKEY is unique
  expr: is_unique(EPIKEY)
  meta:
    severity: error
...
